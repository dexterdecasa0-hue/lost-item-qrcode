<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Found Item Report</title>
<style>
body{font-family:Arial;padding:20px;}
h1{color:#004080;text-align:center;}
.card{border:1px solid #ccc;padding:20px;border-radius:8px;}
button{padding:10px;background:green;color:white;border:none;border-radius:5px;cursor:pointer;}
#emailNotice{margin-top:15px;font-weight:bold;color:blue;}
</style>
</head>
<body>
<h1>Item Information</h1>
<div id="itemCard"></div>
<p id="emailNotice"></p>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyAgDbyZ5koffA_M60oS9x6aaI_UyViLZVw",
  authDomain: "lost-item-qr.firebaseapp.com",
  databaseURL: "https://lost-item-qr-default-rtdb.firebaseio.com",
  projectId: "lost-item-qr",
  storageBucket: "lost-item-qr.appspot.com",
  messagingSenderId: "1026817510307",
  appId: "1:1026817510307:web:9a67340577a04797912816",
  measurementId: "G-QY02LG8PCX"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const params = new URLSearchParams(window.location.search);
const itemId = params.get("item");

db.ref("lostItems/"+itemId).once("value").then(snapshot=>{
  const item = snapshot.val();
  if(!item){
    document.getElementById("itemCard").innerHTML="<p>‚ùå Item not found.</p>";
    return;
  }
  document.getElementById("itemCard").innerHTML=`
    <div class="card">
      <h3>${item.item}</h3>
      <p>Owner: ${item.name} <br>Email: ${item.email}</p>
      <p>Status: ${item.status}</p>
      <button onclick="reportFound(${item.id})">üì¢ Report as Found</button>
    </div>
  `;
});

function reportFound(id){
  db.ref("lostItems/"+id).once("value").then(snap=>{
    const item = snap.val();
    db.ref("lostItems/"+id).update({status:"Reported Found"})
      .then(()=>{
        document.getElementById("emailNotice").innerText=`üìß Notification sent to ${item.email} (simulated)`;
        alert("‚úÖ Report submitted! Owner notified (simulated).");
        location.reload();
      });
  });
}
</script>
</body>
</html>
