<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Lost Items</title>
<style>
body{font-family:Arial;padding:20px;}
h1{color:#004080;text-align:center;}
.item-card{border:1px solid #ccc;padding:15px;margin:10px;border-radius:5px;}
</style>
</head>
<body>
<h1>Lost Items</h1>
<a href="register.html">Register Lost Item</a> | 
<a href="admin-login.html">Admin</a>
<div id="itemsList"></div>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyAgDbyZ5koffA_M60oS9x6aaI_UyViLZVw",
  authDomain: "lost-item-qr.firebaseapp.com",
  databaseURL: "https://lost-item-qr-default-rtdb.firebaseio.com",
  projectId: "lost-item-qr",
  storageBucket: "lost-item-qr.appspot.com",
  messagingSenderId: "1026817510307",
  appId: "1:1026817510307:web:9a67340577a04797912816",
  measurementId: "G-QY02LG8PCX"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

function generateQR(text,size=120){
  const canvas=document.createElement("canvas");
  const ctx=canvas.getContext("2d");
  canvas.width=canvas.height=size;
  ctx.fillStyle="white";ctx.fillRect(0,0,size,size);
  ctx.fillStyle="black";ctx.font="14px Arial";
  ctx.fillText("QR for:",10,20);
  ctx.fillText(text,10,40);
  return canvas;
}

const list=document.getElementById("itemsList");
db.ref("lostItems").on("value", snapshot=>{
  list.innerHTML="";
  const items=snapshot.val();
  if(!items){list.innerHTML="<p>No lost items registered yet.</p>";return;}
  Object.values(items).forEach(item=>{
    const div=document.createElement("div");
    div.className="item-card";
    div.innerHTML=`<h3>${item.item}</h3><p>Owner: ${item.name}<br>Email: ${item.email}</p><p>Status: ${item.status}</p>`;
    const qr=generateQR(window.location.origin+"/item.html?item="+item.id,120);
    div.appendChild(qr);
    list.appendChild(div);
  });
});
</script>
</body>
</html>
