<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Report Found Item - LOST&FOUND</title>
  <style>
    /* (your original styles preserved) */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      background-attachment: fixed;
      margin: 0;
      padding: 0;
      color: #333;
      line-height: 1.6;
      animation: fadeIn 1s ease-in;
      min-height: 100vh;
      position: relative;
    }
    body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><polygon points="50,10 90,90 10,90" fill="rgba(255,255,255,0.05)"/></svg>') repeat;
      animation: float 10s ease-in-out infinite;
      pointer-events: none;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    header {
      background: linear-gradient(135deg, #004080, #0066cc, #0080ff);
      color: white;
      padding: 40px 20px;
      text-align: center;
      box-shadow: 0 6px 12px rgba(0,0,0,0.4);
      position: relative;
    }
    header h1 {
      margin: 0;
      font-size: 2.5em;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.7);
      letter-spacing: 3px;
      position: relative;
      z-index: 1;
    }
    .nav {
      margin-top: 20px;
      position: relative;
      z-index: 1;
    }
    .nav a {
      color: white;
      text-decoration: none;
      margin: 0 15px;
      font-size: 18px;
      transition: color 0.3s ease;
    }
    .nav a:hover {
      color: #ffeb3b;
    }
    .main-content {
      display: flex;
      max-width: 1200px;
      margin: 40px auto;
      gap: 30px;
      padding: 0 20px;
    }
    .container {
      flex: 2;
      background: rgba(255, 255, 255, 0.95);
      padding: 40px;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    }
    .sidebar {
      flex: 1;
      background: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .sidebar h3 {
      color: #004080;
      margin-bottom: 15px;
    }
    .sidebar ul {
      list-style: none;
      padding: 0;
    }
    .sidebar li {
      margin-bottom: 10px;
      padding: 10px;
      background: #f0f0f0;
      border-radius: 5px;
    }
    h1 {
      color: #004080;
      text-align: center;
      margin-bottom: 30px;
    }
    .item-details {
      background: #f9f9f9;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid #ddd;
      margin-bottom: 20px;
    }
    .item-details strong {
      color: #004080;
    }
    .report-form {
      background: #f9f9f9;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid #ddd;
      margin-top: 20px;
      display: none;
    }
    .report-form label {
      font-weight: bold;
      color: #004080;
      display: block;
      margin-top: 15px;
    }
    .report-form input, .report-form textarea, .report-form select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px;
    }
    button {
      background: linear-gradient(135deg, #004080, #0066cc);
      color: white;
      padding: 15px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 18px;
      transition: all 0.3s ease;
      margin-top: 20px;
    }
    button:hover {
      background: linear-gradient(135deg, #0066cc, #0080ff);
      transform: translateY(-3px);
      box-shadow: 0 5px 10px rgba(0,0,0,0.2);
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 15px;
      text-align: center;
      max-width: 400px;
      width: 90%;
    }
    .modal button {
      margin-top: 20px;
      background: #004080;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    footer {
      background: linear-gradient(135deg, #333, #555);
      color: white;
      padding: 20px;
      text-align: center;
      margin-top: 40px;
    }
    footer a {
      color: #ffeb3b;
      text-decoration: none;
    }
    @media (max-width: 768px) {
      .main-content {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>LOST&FOUND</h1>
  <nav class="nav">
    <a href="index.html">Home</a>
    <a href="register.html">Register Item</a>
    <a href="item.html">View Found Items</a>
    <a href="admin-login.html">Admin</a>
  </nav>
</header>

<div class="main-content">
  <div class="container">
    <h1>Report Found Item</h1>
    <div id="itemContainer"></div>
  </div>

  <div class="sidebar">
    <h3>Tips for Reporting</h3>
    <ul>
      <li>If you've found an item, scan its QR code to view owner details.</li>
      <li>Contact the owner directly using the provided information.</li>
      <li>Report the item as found to update its status in the system.</li>
      <li>Keep the item safe until the owner claims it.</li>
      <li>If the item isn't registered, you can still report it below.</li>
    </ul>
  </div>
</div>

<!-- Unregistered Item Section -->
<section style="max-width: 1200px; margin: 40px auto; padding: 0 20px;">
  <div class="container">
    <h2>Report Unregistered Found Item</h2>
    <p>If the item isn't registered (no QR code), you can still report it here.</p>
    <button id="reportUnregisteredBtn">Report Unregistered Item</button>

    <div id="unregisteredForm" class="report-form">
      <label for="itemName">Item Name</label>
      <input type="text" id="itemName" placeholder="e.g., Wallet, Phone, Keys" required>

      <label for="description">Description</label>
      <textarea id="description" placeholder="Detailed description of the item" required></textarea>

      <label for="category">Category</label>
      <select id="category" required>
        <option value="">Select Category</option>
        <option value="Electronics">Electronics</option>
        <option value="Clothing">Clothing</option>
        <option value="Accessories">Accessories</option>
        <option value="Documents">Documents</option>
        <option value="Other">Other</option>
      </select>

      <label for="foundLocation">Where was the item found?</label>
      <input type="text" id="foundLocation" placeholder="e.g., Library, Cafeteria, Room 101" required>

      <label for="finderNotes">Additional Notes (Optional)</label>
      <textarea id="finderNotes" placeholder="Any extra details about the find..."></textarea>

      <label for="itemImage">Upload a Picture of the Found Item</label>
      <input type="file" id="itemImage" accept="image/*" required>

      <label for="finderName">Your Name (Optional)</label>
      <input type="text" id="finderName" placeholder="Your full name">

      <label for="finderEmail">Your Email (Optional)</label>
      <input type="email" id="finderEmail" placeholder="your.email@example.com">

      <label for="finderPhone">Your Phone (Optional)</label>
      <input type="tel" id="finderPhone" placeholder="Your phone number">

      <button type="button" id="submitUnregistered">Submit Report</button>
    </div>
  </div>
</section>

<!-- Success Modal -->
<div id="successModal" class="modal">
  <div class="modal-content">
    <h2>Item Reported!</h2>
    <p>The item has been reported. Thank you for helping!</p>
    <button onclick="closeModal()">Close</button>
  </div>
</div>

<footer>
  <p>&copy; 2025 LOST&FOUND System. <a href="index.html">Back to Home</a></p>
</footer>

<!-- Firebase Scripts -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>

<script>
  // Initialize Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyAgDbyZ5koffA_M60oS9x6aaI_UyViLZVw",
    authDomain: "lost-item-qr.firebaseapp.com",
    databaseURL: "https://lost-item-qr-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "lost-item-qr",
    storageBucket: "lost-item-qr.appspot.com",
    messagingSenderId: "1026817510307",
    appId: "1:1026817510307:web:9a67340577a04797912816",
    measurementId: "G-QY02LG8PCX"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const storage = firebase.storage();

  // Modal control
  function showModal() { document.getElementById("successModal").style.display = "flex"; }
  function closeModal() { document.getElementById("successModal").style.display = "none"; }

  // Registered item reporting
  const urlParams = new URLSearchParams(window.location.search);
  const itemId = urlParams.get("item");
  const container = document.getElementById("itemContainer");

  if (itemId) {
    db.ref("lostItems/" + itemId).once("value").then(snapshot => {
      const item = snapshot.val();
      if (!item) {
        container.innerHTML = "<p>Item not found.</p>";
        return;
      }
      container.innerHTML = `
        <div class="item-details">
          <p><strong>Item Name:</strong> ${item.item}</p>
          <p><strong>Description:</strong> ${item.description}</p>
          <p><strong>Category:</strong> ${item.category}</p>
          <p><strong>Owner:</strong> ${item.name}</p>
          <p><strong>Email:</strong> <a href="mailto:${item.email}">${item.email}</a></p>
          <p><strong>Status:</strong> ${item.status}</p>
        </div>
        <button id="reportBtn">Report as Found</button>
        <div id="reportForm" class="report-form">
          <label for="foundLocation">Where was the item found?</label>
          <input type="text" id="foundLocation" placeholder="e.g., Library, Cafeteria" required>

          <label for="finderNotes">Notes (Optional)</label>
          <textarea id="finderNotes"></textarea>

          <label for="itemImage">Upload Picture</label>
          <input type="file" id="itemImage" accept="image/*" required>

          <label for="finderName">Your Name (Optional)</label>
          <input type="text" id="finderName">

          <label for="finderEmail">Your Email (Optional)</label>
          <input type="email" id="finderEmail">

          <label for="finderPhone">Your Phone (Optional)</label>
          <input type="tel" id="finderPhone">

          <button id="submitReport">Submit Report</button>
        </div>
      `;
      document.getElementById("reportBtn").addEventListener("click", () => {
        document.getElementById("reportForm").style.display = "block";
        document.getElementById("reportBtn").style.display = "none";
      });

      document.getElementById("submitReport").addEventListener("click", async () => {
        const foundLocation = document.getElementById("foundLocation").value.trim();
        const imageFile = document.getElementById("itemImage").files[0];
        if (!foundLocation || !imageFile) {
          alert("Please fill required fields."); return;
        }
        try {
          const refPath = `foundItems/${itemId}_${Date.now()}_${imageFile.name}`;
          const storageRef = storage.ref(refPath);
          await storageRef.put(imageFile);
          const imageUrl = await storageRef.getDownloadURL();
          await db.ref("lostItems/" + itemId).update({
            status: "Found",
            foundLocation,
            finderNotes: document.getElementById("finderNotes").value.trim(),
            finderName: document.getElementById("finderName").value.trim(),
            finderEmail: document.getElementById("finderEmail").value.trim(),
            finderPhone: document.getElementById("finderPhone").value.trim(),
            foundImage: imageUrl,
            foundDate: new Date().toISOString()
          });
          showModal();
        } catch (err) {
          alert("Error reporting item."); console.error(err);
        }
      });
    });
  }

  // Unregistered item reporting
  const reportBtn = document.getElementById("reportUnregisteredBtn");
  const form = document.getElementById("unregisteredForm");
  reportBtn.addEventListener("click", () => {
    form.style.display = "block";
    reportBtn.style.display = "none";
  });
  document.getElementById("submitUnregistered").addEventListener("click", async () => {
    const itemName = document.getElementById("itemName").value.trim();
    const description = document.getElementById("description").value.trim();
    const category = document.getElementById("category").value;
    const foundLocation = document.getElementById("foundLocation").value.trim();
    const imageFile = document.getElementById("itemImage").files[0];
    if (!itemName || !description || !category || !foundLocation || !imageFile) {
      alert("Please fill all required fields."); return;
    }
    try {
      const refPath = `unregisteredFound/${Date.now()}_${imageFile.name}`;
      const storageRef = storage.ref(refPath);
      await storageRef.put(imageFile);
      const imageUrl = await storageRef.getDownloadURL();
      await db.ref("unregisteredReports").push({
        itemName,
        description,
        category,
        foundLocation,
        finderNotes: document.getElementById("finderNotes").value.trim(),
        finderName: document.getElementById("finderName").value.trim(),
        finderEmail: document.getElementById("finderEmail").value.trim(),
        finderPhone: document.getElementById("finderPhone").value.trim(),
        imageUrl,
        reportDate: new Date().toISOString()
      });
      showModal();
      form.reset();
      form.style.display = "none";
    } catch (err) {
      alert("Error submitting report."); console.error(err);
    }
  });
</script>

</body>
</html>
