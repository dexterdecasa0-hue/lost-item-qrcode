<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Report Found Item</title>
<style>
body { font-family: Arial; padding: 20px; text-align:center;}
#itemContainer { max-width: 600px; margin:auto; border:1px solid #ccc; padding:10px; border-radius:5px;}
button { padding:10px 15px; cursor:pointer; background:#004080; color:white; border:none; border-radius:3px; margin-top:10px;}
</style>
</head>
<body>
<h1>Report Found Item</h1>
<div id="itemContainer"></div>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAgDbyZ5koffA_M60oS9x6aaI_UyViLZVw",
  authDomain: "lost-item-qr.firebaseapp.com",
  databaseURL: "https://lost-item-qr-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "lost-item-qr",
  storageBucket: "lost-item-qr.firebasestorage.app",
  messagingSenderId: "1026817510307",
  appId: "1:1026817510307:web:9a67340577a04797912816",
  measurementId: "G-QY02LG8PCX"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const urlParams = new URLSearchParams(window.location.search);
const itemId = urlParams.get("item");
const container = document.getElementById("itemContainer");

if(itemId){
  db.ref("lostItems/"+itemId).once("value").then(snapshot=>{
    const item = snapshot.val();
    if(item){
      container.innerHTML = `
        <strong>Item:</strong> ${item.item}<br>
        <strong>Owner:</strong> ${item.name}<br>
        <strong>Email:</strong> ${item.email}<br>
        <strong>Status:</strong> ${item.status}<br>
        <button id="reportBtn">Report as Found</button>
      `;
      document.getElementById("reportBtn").addEventListener("click", ()=>{
        db.ref("lostItems/"+itemId).update({status:"Found", reportedFound:true})
          .then(()=>{
            alert("✅ Item marked as Found! The owner will be notified (simulated).");
            location.reload();
          });
      });
    } else container.innerHTML="❌ Item not found.";
  });
} else {
  container.innerHTML = "❌ No item scanned. Please scan the QR code.";
}
</script>
</body>
</html>
